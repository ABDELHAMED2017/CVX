<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>Sparse covariance estimation for Gaussian variables</title>
<link rel="canonical" href="http://cvxr.com/cvx/examples/log_exp/html/sparse_covariance_est_tradeoff.html">
<link rel="stylesheet" href="../../examples.css" type="text/css">
</head>
<body>
<div id="header">
<h1>Sparse covariance estimation for Gaussian variables</h1>
Jump to:&nbsp;&nbsp;&nbsp;&nbsp;
<a href="#source">Source code</a>&nbsp;&nbsp;&nbsp;&nbsp;
<a href="#output">Text output</a>
&nbsp;&nbsp;&nbsp;&nbsp;
<a href="#plots">Plots</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../index.html">Library index</a>
</div>
<div id="content">
<a id="source"></a>
<pre class="codeinput">
<span class="comment">% Jo&Atilde;&laquo;lle Skaf - 04/24/08</span>
<span class="comment">% (a figure is generated)</span>
<span class="comment">%</span>
<span class="comment">% Suppose y \in\reals^n is a Gaussian random variable with zero mean and</span>
<span class="comment">% covariance matrix R = \Expect(yy^T), with sparse inverse S = R^{-1}</span>
<span class="comment">% (S_ij = 0 means that y_i and y_j are conditionally independent).</span>
<span class="comment">% We want to estimate the covariance matrix R based on N independent</span>
<span class="comment">% samples y1,...,yN drawn from the distribution, and using prior knowledge</span>
<span class="comment">% that S is sparse</span>
<span class="comment">% A good heuristic for estimating R is to solve the problem</span>
<span class="comment">%           maximize    logdet(S) - tr(SY) - lambda*sum(sum(abs(S)))</span>
<span class="comment">%           subject to  S &gt;= 0</span>
<span class="comment">% where Y is the sample covariance of y1,...,yN, and lambda is a sparsity</span>
<span class="comment">% parameter to be chosen or tuned.</span>
<span class="comment">% A figure showing the sparsity (number of nonzeros) of S versus lambda</span>
<span class="comment">% is generated.</span>

<span class="comment">% Input data</span>
randn(<span class="string">'state'</span>,0);
n = 10;
N = 100;
Strue = sprandsym(n,0.5,0.01,1);
nnz_true = sum(Strue(:)&gt;1e-4);
R = inv(full(Strue));
y_sample = sqrtm(R)*randn(n,N);
Y = cov(y_sample');
Nlambda = 20;
lambda = logspace(-2, 3, Nlambda);
nnz = zeros(1,Nlambda);

<span class="keyword">for</span> i=1:Nlambda
    disp([<span class="string">'i = '</span> num2str(i) <span class="string">', lambda(i) = '</span> num2str(lambda(i))]);
    <span class="comment">% Maximum likelihood estimate of R^{-1}</span>
    cvx_begin <span class="string">sdp</span>
        variable <span class="string">S(n,n)</span> <span class="string">symmetric</span>
        maximize <span class="string">log_det(S)</span> <span class="string">-</span> <span class="string">trace(S*Y)</span> <span class="string">-</span> <span class="string">lambda(i)*sum(sum(abs(S)))</span>
        S &gt;= 0
    cvx_end
    nnz(i) = sum(S(:)&gt;1e-4);
<span class="keyword">end</span>

figure;
semilogx(lambda, nnz);
hold <span class="string">on</span>;
semilogx(lambda, nnz_true*ones(1,Nlambda),<span class="string">'r'</span>);
xlabel(<span class="string">'\lambda'</span>);
legend(<span class="string">'nonzeros in S'</span>, <span class="string">'nonzeros in R^{-1}'</span>);
</pre>
<a id="output"></a>
<pre class="codeoutput">
i = 1, lambda(i) = 0.01
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.837e+00  3.355e-01  Solved
1   1.453e-01  1.747e-03  Solved
1   7.642e-04  7.314e-08  Solved
1   3.546e-09  2.463e-08  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -31.3012
i = 2, lambda(i) = 0.01833
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.840e+00  3.370e-01  Solved
1   1.459e-01  1.763e-03  Solved
1   7.709e-04  9.338e-08  Solved
1   1.632e-08  4.127e-08  Solved
1   4.811e-08S 4.099e-09  Solved
1   3.655e-09  1.180e-09  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -31.3504
i = 3, lambda(i) = 0.033598
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.847e+00  3.396e-01  Solved
1   1.470e-01  1.791e-03  Solved
1   7.828e-04  1.208e-07  Solved
1   2.147e-08  6.490e-08  Solved
1   8.856e-08S 9.286e-09  Solved
1   1.183e-08  1.409e-09  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -31.4368
i = 4, lambda(i) = 0.061585
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.857e+00  3.441e-01  Solved
1   1.489e-01  1.837e-03  Solved
1   8.033e-04  1.785e-07  Solved
1   1.582e-08  1.218e-07  Solved
1   1.393e-07S 1.235e-08  Solved
1   1.730e-08  4.937e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -31.5845
i = 5, lambda(i) = 0.11288
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.875e+00  3.515e-01  Solved
1   1.521e-01  1.916e-03  Solved
1   8.382e-04  1.865e-07  Solved
1   1.560e-08  1.278e-07  Solved
1   1.627e-07S 3.303e-09  Solved
1   4.063e-09  7.706e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -31.8272
i = 6, lambda(i) = 0.20691
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.903e+00  3.633e-01  Solved
1   1.572e-01  2.047e-03  Solved
1   8.955e-04  1.293e-07  Solved
1   2.758e-08  6.254e-08  Solved
1   0.000e+00  6.252e-08S Solved
1   9.209e-08S 1.439e-08  Solved
1   2.500e-08  1.703e-09  Solved
1   1.549e-09  0.000e+00  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -32.2113
i = 7, lambda(i) = 0.37927
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   1.946e+00  3.818e-01  Solved
1   1.651e-01  2.260e-03  Solved
1   9.887e-04  1.080e-07  Solved
1   3.177e-08  2.613e-08  Solved
1   2.917e-08S 2.202e-09  Solved
1   2.656e-09  1.996e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -32.8011
i = 8, lambda(i) = 0.69519
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.008e+00  4.098e-01  Solved
1   1.770e-01  2.602e-03  Solved
1   1.138e-03  2.216e-07  Solved
1   4.334e-08  1.146e-07  Solved
1   0.000e+00  1.144e-07S Solved
1   1.606e-07S 4.687e-09  Solved
1   4.729e-10  1.400e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -33.6657
i = 9, lambda(i) = 1.2743
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.094e+00  4.503e-01  Solved
1   1.942e-01  3.140e-03  Solved
1   1.373e-03  2.357e-07  Solved
1   6.492e-08  7.527e-08  Solved
1   0.000e+00  7.494e-08S Solved
1   1.064e-07S 7.441e-09  Solved
1   1.010e-08  6.243e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -34.876
i = 10, lambda(i) = 2.3357
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.206e+00  5.072e-01  Solved
1   2.184e-01  3.979e-03  Solved
1   1.740e-03  3.273e-07  Solved
1   1.067e-07  7.459e-08  Solved
1   0.000e+00  7.452e-08S Solved
1   9.018e-08S 1.349e-08  Solved
1   1.276e-08  4.276e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -36.4981
i = 11, lambda(i) = 4.2813
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.345e+00  5.839e-01  Solved
1   2.509e-01  5.261e-03  Solved
1   2.302e-03  4.760e-07  Solved
1   1.859e-07  5.585e-08  Solved
1   0.000e+00  5.581e-08S Solved
1   6.138e-08S 1.155e-08  Solved
1   1.452e-08  6.719e-10  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -38.5618
i = 12, lambda(i) = 7.8476
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.511e+00  6.842e-01  Solved
1   2.930e-01  7.209e-03  Solved
1   3.154e-03  8.354e-07  Solved
1   3.481e-07  1.386e-09  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -41.092
i = 13, lambda(i) = 14.3845
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.700e+00  8.127e-01  Solved
1   3.466e-01  1.015e-02  Solved
1   4.435e-03  1.988e-04  Solved
1   6.918e-07  0.000e+00  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -44.1061
i = 14, lambda(i) = 26.3665
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   2.917e+00  9.786e-01  Solved
1   4.153e-01  1.466e-02  Solved
1   6.412e-03  3.326e-06  Solved
1   1.463e-06  0.000e+00  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -47.7294
i = 15, lambda(i) = 48.3293
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   3.157e+00  1.191e+00  Solved
1   5.015e-01  2.157e-02  Solved
1   9.431e-03  7.240e-06  Solved
1   3.173e-06  0.000e+00  Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -51.9812
i = 16, lambda(i) = 88.5867
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   3.412e+00  1.448e+00  Solved
1   6.055e-01  3.178e-02  Solved
0   0.000e+00  0.000e+00  Failed
0   0.000e+00S 0.000e+00S Failed
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -64831.7
i = 17, lambda(i) = 162.3777
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   3.672e+00  1.751e+00  Solved
1   7.258e-01  4.744e-02  Solved
1   2.020e-02  3.317e-05  Solved
1   1.281e-05  1.765e-04S Inaccurate/Solved
1   0.000e+00  1.763e-04S Inaccurate/Solved
1   0.000e+00S 1.763e-04S Failed
1   0.000e+00S 1.763e-04S Failed
1   0.000e+00S 1.763e-04S Failed
-----------------------------------------------------------------
Status: Failed
Optimal value (cvx_optval): NaN
i = 18, lambda(i) = 297.6351
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   3.926e+00  2.097e+00  Solved
1   8.599e-01  6.575e-02  Inaccurate/Solved
1   2.874e-02  5.900e-04  Inaccurate/Solved
1   2.912e-05  7.235e-05  Inaccurate/Solved
1   0.000e+00  1.118e-04S Inaccurate/Solved
1   0.000e+00S 7.758e-05  Failed
1   0.000e+00S 1.119e-04S Failed
1   0.000e+00S 1.119e-04S Failed
-----------------------------------------------------------------
Status: Failed
Optimal value (cvx_optval): NaN
i = 19, lambda(i) = 545.5595
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   4.170e+00  2.479e+00  Solved
1   1.005e+00  9.489e-02  Failed
1   3.949e-02  0.000e+00  Failed
1   9.884e-05  0.000e+00S Inaccurate/Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -73.4074
i = 20, lambda(i) = 1000
 
Successive approximation method to be employed.
   sedumi will be called several times to refine the solution.
   Original size: 502 variables, 279 equality constraints
   1 exponentials add 8 variables, 5 equality constraints
-----------------------------------------------------------------
          Errors   
Act Centering    Conic    Status
-----------------------------------
1   4.398e+00  2.883e+00  Failed
1   1.158e+00  1.231e-01  Solved
1   5.187e-02  0.000e+00  Failed
1   8.298e-05  1.702e-04S Inaccurate/Solved
-----------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): -79.332
</pre>
<a id="plots"></a>
<div id="plotoutput">
<img src="sparse_covariance_est_tradeoff__01.png" alt=""> 
</div>
</div>
</body>
</html>